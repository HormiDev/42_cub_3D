# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: ide-dieg <ide-dieg@student.42madrid.com    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/03/12 12:36:27 by ide-dieg          #+#    #+#              #
#    Updated: 2025/05/17 01:31:52 by ide-dieg         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

smhrnasmhrnasmhrnaG = \033[1;32m
Y = \033[1;33m
R = \033[0;31m
NC = \033[0m

NAME = cub3D

VPATH	=	src/:\
			src/render/:\


SRC		=	src/main.c \
			DEBUG/ft_debug.c \
			src/ft_loading_game.c \
			src/ft_close_game.c \
			src/ft_config_player.c \
			src/ft_config_mlx.c \
			src/parse/ft_parse_textures.c \
			src/parse/ft_check_args.c \
			src/parse/ft_parse_colors.c \
			src/parse/ft_parse_map.c \
			src/parse/ft_check_map.c \
			src/parse/ft_create_game_map.c \
			src/parse/ft_map_origin.c \
			src/parse/ft_walls_closed.c \
			src/render/ft_draw_map.c \
			src/game/ft_movement_2d.c \

OBJ_DIR  = objects

LIBSA = minilibx-linux/libmlx.a \
		42_Libft/libft.a \

LFLAGS = -lXext -lX11 -lm

OBJ = $(patsubst %.c, $(OBJ_DIR)/%.o, $(SRC))

CC = cc
CFLAGS = -Wall -Wextra -Werror -g -fsanitize=address

all: clear $(NAME) title_print

update_submodules:
	@echo "$(Y)----------------------------------------------------------------------------------------------------$(NC)"
	@echo "$(Y)-----------------------------------------Updating submodules----------------------------------------$(NC)"
	@echo "$(Y)----------------------------------------------------------------------------------------------------$(NC)\n"
	@git submodule update --init --recursive > /dev/null 2>&1
	@tput cuu1 && tput el
	@tput cuu1 && tput el
	@tput cuu1 && tput el
	@tput cuu1 && tput el
	@echo "$(G)----------------------------------------------------------------------------------------------------$(NC)"
	@echo "$(G)---------------------------------------- Submodules updated! ---------------------------------------$(NC)"
	@echo "$(G)----------------------------------------------------------------------------------------------------$(NC)\n"

clear:
	clear

$(NAME): update_submodules build_libft build_minilibx-linux $(OBJ)
	@printf "%-183s\r" "" 
	@$(CC) $(CFLAGS) $(OBJ) $(LIBSA) $(LFLAGS) -o $(NAME)
	@echo "$(G)----------------------------------- CUB3D Finished Compiling -----------------------------------$(NC)\n"

build_libft:
	@if [ ! -f 42_Libft/libft.a ]; then \
		echo "$(Y)----------------------------------------------------------------------------------------------------$(NC)"; \
		echo "$(Y)------------------------------------------ Compiling Libft -----------------------------------------$(NC)"; \
		echo "$(Y)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		make all -C 42_Libft > /dev/null 2>&1; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		if [ -f 42_Libft/libft.a ]; then \
			echo "$(G)----------------------------------------------------------------------------------------------------$(NC)"; \
			echo "$(G)------------------------------------------ Libft Compiled ------------------------------------------$(NC)"; \
			echo "$(G)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		else \
			echo "$(R)----------------------------------------------------------------------------------------------------$(NC)"; \
			echo "$(R)-------------------------------------- Libft Compilation Failed ------------------------------------$(NC)"; \
			echo "$(R)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		fi; \
	fi

fclean_libft:
	@make fclean -C 42_Libft > /dev/null 2>&1
	@echo "$(R)------------------------------------------ Libft Cleaned -------------------------------------------$(NC)"

build_minilibx-linux:
	@if [ ! -f minilibx-linux/libmlx.a ]; then \
		echo "$(Y)----------------------------------------------------------------------------------------------------$(NC)"; \
		echo "$(Y)------------------------------------- Compiling Minilibx-linux -------------------------------------$(NC)"; \
		echo "$(Y)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		make -C minilibx-linux > /dev/null 2>&1; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		tput cuu1 && tput el; \
		if [ -f minilibx-linux/libmlx.a ]; then \
			echo "$(G)----------------------------------------------------------------------------------------------------$(NC)"; \
			echo "$(G)------------------------------------- Minilibx-linux Compiled --------------------------------------$(NC)"; \
			echo "$(G)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		else \
			echo "$(R)----------------------------------------------------------------------------------------------------$(NC)"; \
			echo "$(R)--------------------------------- Minilibx-linux Compilation Failed --------------------------------$(NC)"; \
			echo "$(R)----------------------------------------------------------------------------------------------------\n$(NC)"; \
		fi; \
	fi

fclean_minilibx-linux:
	@echo "Cleaning Minilibx-linux..."
	@make -C minilibx-linux clean > /dev/null 2>&1
	@echo "Minilibx-linux cleaned!"

$(OBJ_DIR):
	@echo "$(Y)--------------------------------------- Compiling  CUB3D ---------------------------------------$(NC)"
	@echo "$(R)---------------------------------- Object Directory Doesn't Exist ----------------------------------$(NC)"
	@echo "$(Y)------------------------------------ Creating Objects Directory ------------------------------------$(NC)"
	@mkdir -p $(OBJ_DIR)
	@echo "$(G)-------------------------------------- Objects Directory Done --------------------------------------\n$(NC)"

$(OBJ_DIR)/%.o: %.c | $(OBJ_DIR)
	@mkdir -p $(dir $@)
	@$(CC) $(CFLAGS) -c -o $@ $<

clean: clear
	@rm -rf $(OBJ_DIR)
	@find src -type f -name '*.o' -delete
	@echo "$(R)----------------------------------------- Objects  Cleaned -----------------------------------------$(NC)"

fclean: clean fclean_libft fclean_minilibx-linux
	@rm -f $(NAME)
	@echo "$(R)------------------------------------------ CUB3D Is Clean ------------------------------------------\n$(NC)"

re: fclean $(NAME) title_print

title_print:                                                                                                                
	@echo "$(G)                                            ..:-+**#*+:.                                          			$(NC)"
	@echo "$(G)                                        ..-##%%%%%%%%%#*-.                                        			$(NC)"
	@echo "$(G)                                     ..=%%@@@@@@@@@%##%%#:                                        			$(NC)"
	@echo "$(G)                                    .*#@@@@@@@%@@@%%%%%%#.                                        			$(NC)"
	@echo "$(G)                                  .#@@@@@%@@@@@%%%%%#%#*.                                         			$(NC)"
	@echo "$(G)                                .+@@@@@@@@%%%%%%%%%%%=..    .-#%:                                 			$(NC)"
	@echo "$(G)                               -%@@@@@@@@%%%%%%%%*..      .%@@@%#.                                			$(NC)"
	@echo "$(G)                             .*@@@@@@@@@@%%%%+:..        :@%+...                                  			$(NC)"
	@echo "$(G)                            .#@@@@@@@@%@@@%=.        .-.+@@%:  ..   :*%%:                         			$(NC)"
	@echo "$(G)                           :%@@@@@@%@@@@@@=+#%%%%#=:*+%@@@@...=+  -%@@#=:.                        			$(NC)"
	@echo "$(G)                          :%@@@@@@@@@%@@@@@%%@@%%%%%%%%%@@@%#+:..=@%#.                            			$(NC)"
	@echo "$(G)                         .#%@@@@@@@@@@@@@@@%@@@@@%@%%%#%%%#*-:=*%@%@+                             			$(NC)"
	@echo "$(G)                        .+%@@@@@@@@@@@@@@@@@@%%@@@@@@%%%%%%@%@@@@%@@:                             			$(NC)"
	@echo "$(G)                        -%%@@@@@@%@@@@@@@@@@@@@@@@@@@%%%%%*%%%%%@@@:                              			$(NC)"
	@echo "$(G)                       .#%%@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@%#*#%%@@@%=.+.                           			$(NC)"
	@echo "$(G)                      .=%%%%%%@@@@@%%%@%%%%%%%%@@@@@@@@@@@@%##%@@@@%+*.                           			$(NC)"
	@echo "$(G)                      .#%@%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@%%%#%@@@@-.                           			$(NC)"
	@echo "$(G)                .     :#%%%@%%%%%%%##..#%%#%#%%%%%@@@@@@@@@@@@%%%%@@@%:.                          			$(NC)"
	@echo "$(G)                .     :%%@@@%%%%%%%%:   .+#*+*##%%%%%%@@@@@@@@@%@@@%#+*=.                         			$(NC)"
	@echo "$(G)               ..     .#%@@%%%#%%%##.     ..--+*#%%%%%@@@@@@@@%%@@@@@%=:.                         			$(NC)"
	@echo "$(G)               -.     .-%@@@%#+-=%%*.        .+**#%%%%@@@@@@@@@@#%@@@@%+*.                        			$(NC)"
	@echo "$(G)              .#.       -@@@%=:=%%%.         -###%%%%%%%%@@@@@@@@@@@@@@@@###*+*.                  			$(NC)"
	@echo "$(G)              **.        .+*-..#%%#          .:+#%%%%%%%@@@@@@@%%@@@@@@@#:                        			$(NC)"
	@echo "$(G)           :%@%.              .:=%+            ..:=+###@%@@@@@#%@@@@@@@@%+#=                      			$(NC)"
	@echo "$(G)          .#@@=                  ..                   ....:=*#@@@@@@@@@@@@%#*-: .                 			$(NC)"
	@echo "$(G)         .:%%%-                                            .+%@@@@@@@@@@@@@@%%@@@%%.              			$(NC)"
	@echo "$(G)        .%@@+-.                                    ..:==*##%@@@@@@@@@@@%%@@%%@@@#-.               			$(NC)"
	@echo "$(G)        .%@%*=-                              .:=*#%@@@@@@%@@@@@@@@@@@@@@@%%%@@@@%*=**-.           			$(NC)"
	@echo "$(G)       .@@@*=#-                          ..+%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%-         			$(NC)"
	@echo "$(G)       .#@@*...                        .-%@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@-:.          			$(NC)"
	@echo "$(G)       -@@%-*+-                     .:*%%@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@+            			$(NC)"
	@echo "$(G)       .%@@*.:..                   .+%@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@#.:#@@@@@@#-:.         			$(NC)"
	@echo "$(G)       .*@@*=%-.                  .*%@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@%#.   -%@@@@@@@+.        			$(NC)"
	@echo "$(G)       .#@@@+.::..                 :@@@@@@@@@@@@@@%@@@@%@@@@@@@@@@@@@@@*.       +%@@@@@%@+.       			$(NC)"
	@echo "$(G)         +@@*:@=.                  .%%@@%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@*...     .#%@@@%: ...       			$(NC)"
	@echo "$(G)         +@@@%.....                   %@@%%%%@@@@=@@@#%@@@@@@@@@@@@@@@%:*@@@=    .%@@@@@@.         			$(NC)"
	@echo "$(G)         .+@@@:+#..                      %@@%%%%@@@@@:@:+     .....:%@@@@@@@@@+    *@@@@@@@+.        		$(NC)"
	@echo "$(G)          .-@@@%..#%-                        %@@%%%%@@@@          .:@@@@@@@-   		.#@@@@@*=@#.       		$(NC)"
	@echo "$(G)           .*@@@#.+*.                          .@%.-%.%:            =@@@@@@:   			..%@@@#. ...      	$(NC)"
	@echo "$(G)            ..+@@@@%=.*%.                      .%@: :%.=.           :@@@@@%.   			.*@@@@@@%.          $(NC)"
	@echo "$(G)              .=%@@@@@+.                        :@@. :%.            .:@@@..     			 :+@@@@@@*.       	$(NC)"
	@echo "$(G)                .-@@@%..#%-                      .:.@ .+:           ..:@@@..              .#@@@@@*=       	$(NC)"
	@echo "$(G)                   	@@@%..#%                     ..@  .:..                             .*@@@@@@%.  			$(NC)"                                                        
	@echo "$(G)						   *##%@@@..#%		                                       		  .#%@@@%: .			$(NC)"
	@echo "$(G)				      		*##%@@@@@.		                               			   -%@@@@@:					$(NC)"															
	@echo "$(G)							    .-@@@@%@@@@										  .-@@@@%@..				    $(NC)"															
	@echo "$(G)								   	 :%.=@@@@%@@                     	.	 *@@@@@@%:.		                    $(NC)"															
	@echo "$(G)										 ###*##%@@@@@.-@@@%..#%--@@@%..#%-#@@@@@*:.                             $(NC)"
	@echo "$(G)												*##%@@@@@.-@@@%..#%-.#@:::.	                                    $(NC)"
	@echo "$(G)											                                       								$(NC)"										
	@echo "	                                $(G)ide-dieg $(Y)/ $(R)ismherna$(NC)"
	@echo "	                             $(Y)$(NC)\n"


                                                
norm: clearif

.PHONY: all clean fclean re clear title_print